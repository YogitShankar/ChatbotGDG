{
    "url": "https://codeforces.com/problemset/problem/2046/E2",
    "title": "E2. Cheops and a Contest (Hard Version)",
    "tags": [
        "greedy",
        "implementation",
        "*3500"
    ],
    "content": "E2. Cheops and a Contest (Hard Version)time limit per test4 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard output This is the hard version of the problem. The difference between the versions is that in this version, \ud835\udc5am is arbitrary. You can hack only if you solved all versions of this problem. There is a problem-solving competition in Ancient Egypt with \ud835\udc5bn participants, numbered from 11 to \ud835\udc5bn. Each participant comes from a certain city; the cities are numbered from 11 to \ud835\udc5am. There is at least one participant from each city.The \ud835\udc56i-th participant has strength \ud835\udc4e\ud835\udc56ai, specialization \ud835\udc60\ud835\udc56si, and wisdom \ud835\udc4f\ud835\udc56bi, so that \ud835\udc4f\ud835\udc56\u2265\ud835\udc4e\ud835\udc56bi\u2265ai. Each problem in the competition will have a difficulty \ud835\udc51d and a unique topic \ud835\udc61t. The \ud835\udc56i-th participant will solve the problem if   \ud835\udc4e\ud835\udc56\u2265\ud835\udc51ai\u2265d, i.e., their strength is not less than the problem's difficulty, or  \ud835\udc60\ud835\udc56=\ud835\udc61si=t, and \ud835\udc4f\ud835\udc56\u2265\ud835\udc51bi\u2265d, i.e., their specialization matches the problem's topic, and their wisdom is not less than the problem's difficulty. Cheops wants to choose the problems in such a way that each participant from city \ud835\udc56i will solve strictly more problems than each participant from city \ud835\udc57j, for all \ud835\udc56<\ud835\udc57i<j.Please find a set of at most 5\ud835\udc5b5n problems, where the topics of all problems are distinct, so that Cheops' will is satisfied, or state that it is impossible.InputEach test contains multiple test cases. The first line contains the number of test cases \ud835\udc47T (1\u2264\ud835\udc47\u22641041\u2264T\u2264104). The description of the test cases follows. The first line of each test case contains two integers \ud835\udc5bn, \ud835\udc5am (2\u2264\ud835\udc5a\u2264\ud835\udc5b\u22643\u22c51052\u2264m\u2264n\u22643\u22c5105)\u00a0\u2014 the number of participants and the number of cities.The following \ud835\udc5bn lines describe the participants. The \ud835\udc56i-th line contains three integers \u2014\ud835\udc4e\ud835\udc56ai, \ud835\udc4f\ud835\udc56bi, \ud835\udc60\ud835\udc56si (0\u2264\ud835\udc4e\ud835\udc56,\ud835\udc4f\ud835\udc56,\ud835\udc60\ud835\udc56\u22641090\u2264ai,bi,si\u2264109, \ud835\udc4e\ud835\udc56\u2264\ud835\udc4f\ud835\udc56ai\u2264bi)\u00a0\u2014 strength, wisdom, and specialization of the \ud835\udc56i-th participant, respectively.The next \ud835\udc5am lines describe the cities. In the \ud835\udc56i-th line, the first number is an integer \ud835\udc58\ud835\udc56ki (1\u2264\ud835\udc58\ud835\udc56\u2264\ud835\udc5b1\u2264ki\u2264n)\u00a0\u2014 the number of participants from the \ud835\udc56i-th city. It is followed by \ud835\udc58\ud835\udc56ki integers \ud835\udc5e\ud835\udc56,1,\ud835\udc5e\ud835\udc56,2,\u2026,\ud835\udc5e\ud835\udc56,\ud835\udc58\ud835\udc56qi,1,qi,2,\u2026,qi,ki\u00a0\u2014 (1\u2264\ud835\udc5e\ud835\udc56,\ud835\udc57\u2264\ud835\udc5b1\u2264qi,j\u2264n, 1\u2264\ud835\udc57\u2264\ud835\udc58\ud835\udc561\u2264j\u2264ki)\u00a0\u2014 the indices of the participants from this city. It is guaranteed that each participant is mentioned exactly once.It is guaranteed that the sum of \ud835\udc5bn over all test cases does not exceed 3\u22c51053\u22c5105. OutputFor each test case, if there exists a set of problems that satisfies Cheops' conditions, then in the first line output a single integer \ud835\udc5dp (1\u2264\ud835\udc5d\u22645\ud835\udc5b1\u2264p\u22645n)\u00a0\u2014 the number of problems in your solution.Then output \ud835\udc5dp lines, each containing two integers \ud835\udc51d and \ud835\udc61t (0\u2264\ud835\udc51,\ud835\udc61\u22641090\u2264d,t\u2264109)\u00a0\u2014 the difficulty and topic of the respective problem. The topics must be distinct.If there is no set of problems that meets Cheops' wishes, print \u22121\u22121 instead.ExampleInputCopy25 25 7 16 7 23 9 25 10 34 4 12 1 23 3 4 52 21 2 11 2 11 21 1OutputCopy7\n6 4\n6 5\n5 6\n5 7\n4 8\n4 9\n7 1\n-1..."
}