{
    "problem_id": "F2",
    "contest_id": "1844",
    "name": "F2. Min Cost Permutation (Hard Version)",
    "url": "https://codeforces.com/contest/1844/problem/F2",
    "difficulty": "*2800",
    "tags": [
        "binarysearch",
        "constructivealgorithms",
        "datastructures",
        "greedy",
        "math",
        "sortings"
    ],
    "time_limit": "3 seconds",
    "memory_limit": "256 megabytes",
    "input_specification": "Input\nEach test contains multiple test cases. The first line contains the number of test cases t (1\u2264t\u2264104). The description of the test cases follows.\nThe first line of each test case contains two integers n and c (1\u2264n\u22642\u22c5105, \u2212109\u2264c\u2264109).\nThe second line of each test case contains n integers a1,\u2026,an (1\u2264ai\u2264109).\nIt is guaranteed that the sum of n over all test cases does not exceed 2\u22c5105.",
    "output_specification": "Output\nFor each test case, output n integers b1,\u2026,bn, the lexicographically smallest permutation of a that achieves the minimum n\u22121\u2211i=1|bi+1\u2212bi\u2212c|.",
    "sample_tests": "Input\nCopy\n3\n6 -7\n3 1 4 1 5 9\n3 2\n1 3 5\n1 2718\n2818\nOutput\nCopy\n9 3 1 4 5 1\n1 3 5\n2818"
}